#!/bin/bash
#
# Deletes all branches that are merged into the current branch

set -u -o pipefail

BRANCHES=( $(git branch --merged | awk '/^[^*]/ { print $1 }') )

if [[ "${#BRANCHES[@]}" == 0 ]]; then
    echo 'No merged branches to delete'
else
    git branch -d "${BRANCHES[@]}"
fi

# prune remote branches for good measure
git remote prune origin
